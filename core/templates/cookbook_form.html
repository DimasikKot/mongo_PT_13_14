{% extends "base.html" %}
{% block content %}

<h2>{% if cookbook %}Редактировать книгу{% else %}Добавить книгу{% endif %}</h2>

<form method="post">
    {% csrf_token %}

    <input name="cookbook_name" value="{{ cookbook.cookbook_name }}" placeholder="Название книги" required><br>

    <h3>Рецепты</h3>
    <div id="recipes-container">
        {% if cookbook %}
            {% for recipe in cookbook.recipes %}
                <div class="recipe-block">
                    <input name="recipe_title" value="{{ recipe.title }}" placeholder="Название" required>
                    <input name="recipe_time" value="{{ recipe.cooking_time_minutes }}" placeholder="Время (мин)" required>
                    <input name="recipe_ingredients" value="{{ recipe.ingredients|join:', ' }}" placeholder="Ингредиенты" required>
                    <button type="button" onclick="this.parentElement.remove()">Удалить</button>
                </div>
            {% endfor %}
        {% endif %}
    </div>

    <button type="button" onclick="addRecipe()">Добавить рецепт</button>
    <br><br>
    <button type="submit">Сохранить</button>
</form>

<script>
function addRecipe() {
    const container = document.getElementById('recipes-container');
    const div = document.createElement('div');
    div.className = 'recipe-block';
    div.innerHTML = `
        <input name="recipe_title" placeholder="Название" required>
        <input name="recipe_time" placeholder="Время (мин)" required>
        <input name="recipe_ingredients" placeholder="Ингредиенты через запятую" required>
        <button type="button" onclick="this.parentElement.remove()">Удалить</button>
        <br>
    `;
    container.appendChild(div);
}
</script>

{% endblock %}
