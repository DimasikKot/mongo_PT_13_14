{% extends "base.html" %}
{% block content %}

<div class="card">
    <h2>{% if pizzeria %}Редактировать пиццерию{% else %}Добавить пиццерию{% endif %}</h2>

    <form method="post" style="padding-right: 24px">
        {% csrf_token %}

        <h3 style="margin-top: 24px;">Основная информация</h3>

        <div class="md-textfield">
            <input name="name" value="{{ pizzeria.name|default:'' }}" placeholder=" " required>
            <label>Название</label>
        </div>

        <div class="md-textfield">
            <input name="address" value="{{ pizzeria.address|default:'' }}" placeholder=" " required>
            <label>Адрес</label>
        </div>

        <div class="md-textfield">
            <input name="phone" value="{{ pizzeria.phone|default:'' }}" placeholder=" " required>
            <label>Телефон</label>
        </div>

        <h3 style="margin-top: 32px;">Пиццы</h3>

        <div id="pizzas-container">
            {% if pizzeria %}
                {% for pizza in pizzeria.pizzas %}
                    <div class="pizza-block card" style="margin-bottom: 16px; padding: 16px; padding-right: 40px">
                        <div class="md-textfield">
                            <input name="pizza_name" value="{{ pizza.name }}" placeholder=" " required>
                            <label>Название</label>
                        </div>
                        <div class="md-textfield">
                            <input name="pizza_price" value="{{ pizza.price }}" placeholder=" " required>
                            <label>Цена (₽)</label>
                        </div>
                        <div class="md-textfield">
                            <input name="pizza_weight" value="{{ pizza.weight }}" placeholder=" " required>
                            <label>Вес (г)</label>
                        </div>
                        <div class="md-textfield">
                            <input name="pizza_ingredients" value="{{ pizza.ingredients|join:', ' }}" placeholder=" " required>
                            <label>Ингредиенты через запятую</label>
                        </div>
                        <button type="button" class="md-button secondary" onclick="this.parentElement.remove()">Удалить</button>
                    </div>
                {% endfor %}
            {% endif %}
        </div>

        <button type="button" class="md-button secondary" onclick="addPizza()">Добавить пиццу</button>
        <br><br>
        <button type="submit" class="md-button">Сохранить</button>
    </form>
</div>

<script>
function addPizza() {
    const container = document.getElementById('pizzas-container');
    const div = document.createElement('div');
    div.className = 'pizza-block card';
    div.style.marginBottom = '16px';
    div.style.padding = '16px';
    div.innerHTML = `
        <div class="md-textfield">
            <input name="pizza_name" placeholder=" " required>
            <label>Название</label>
        </div>
        <div class="md-textfield">
            <input name="pizza_price" placeholder=" " required>
            <label>Цена (₽)</label>
        </div>
        <div class="md-textfield">
            <input name="pizza_weight" placeholder=" " required>
            <label>Вес (г)</label>
        </div>
        <div class="md-textfield">
            <input name="pizza_ingredients" placeholder=" " required>
            <label>Ингредиенты через запятую</label>
        </div>
        <button type="button" class="md-button secondary" onclick="this.parentElement.remove()">Удалить</button>
    `;
    container.appendChild(div);
}
</script>

{% endblock %}